

REGISTER:

const registerForm = document.getElementById("register-form");

registerForm.addEventListener("submit", (event) => {
    event.preventDefault();
    console.log(event);
    const name = event.target[0].value;
    const email = event.target[1].value;
    const password = event.target[2].value;
    console.log(name, email, password);
    registerUser(name, email, password);

})

FETCH:

export async function doFetch(url, isAuth = false, options = {}) {
    try {
        const headers = {
            "Content-Type": "application/json",
        };

        if (isAuth) { 
            const authToken = getAuthToken();
            headers["Authorization"] = `Bearer ${authToken}`; //add authorization
        }

        const combinedOptions = {headers, ...options};

        console.log(combinedOptions);
        const response = await fetch(url, combinedOptions);
        console.log(response);
        const json = await response.json();
        return json;
    } catch (error) {
        console.log(error);
        throw error;
    } finally {

    }
}

REGISTER USER: 
export async function registerUser(name, email, password) {
    console.log("register user");
    await doFetch(REGISTER_URL, {
        method: "POST",
        body: JSON.stringify ({
            name,
            email,
            password,
        }),
    });
}

HANDLE AUTH:

export const addAuthToken = (token) => {
    //Get auth token from local storage
    localStorage.setItem("access-token", token)
};

export const getAuthToken = () => {
    const accessToken = localStorage.getItem("access-token")
    return accessToken;
};